<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Eco Recycle Classifier</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #e8f5e9;
    color: #1b5e20;
    margin: 0;
    padding: 0;
  }
  header {
    background: #43a047;
    color: white;
    padding: 20px;
    text-align: center;
    font-size: 1.8rem;
    font-weight: bold;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  .container {
    max-width: 900px;
    margin: 20px auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  button {
    padding: 10px 16px;
    font-size: 1rem;
    background: #66bb6a;
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  button:hover { background: #57a65d; transform: scale(1.05); }
  #webcam-container canvas {
    border-radius: 12px;
    border: 5px solid #c8e6c9;
    animation: pulse 2s infinite;
  }
  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(76,175,80,0.5); }
    70% { box-shadow: 0 0 0 15px rgba(76,175,80,0); }
    100% { box-shadow: 0 0 0 0 rgba(76,175,80,0); }
  }
  #prediction-box {
    margin-top: 20px;
    padding: 16px;
    border-radius: 10px;
    background: #f1f8e9;
    font-size: 1.2rem;
    text-align: center;
    min-height: 60px;
    border: 2px solid #a5d6a7;
    transition: all 0.4s ease;
  }
  .bin-guide {
    margin-top: 20px;
    background: #e9f7ef;
    padding: 20px;
    border-radius: 12px;
    border-left: 6px solid #4caf50;
  }
  .bin-guide h3 { margin-top: 0; }
  .sound-button {
    margin-top: 10px;
    background: #4caf50;
  }
</style>
</head>
<body>
<header>
  ‚ôªÔ∏è Eco-Friendly Recycling Classifier
</header>
<div class="container">
  <h2>What this tool does</h2>
  <p>
    This website uses a Teachable Machine model to classify items as
    <strong>Recyclable</strong>, <strong>Trash</strong>, or <strong>Compostable</strong>.
    It helps the general public correctly sort waste and reduce contamination in recycling bins.
  </p>

  <h2>How to use it</h2>
  <ol>
    <li>Place an object in front of your webcam.</li>
    <li>Click <strong>Start</strong> to load the model and activate the camera.</li>
    <li>Watch the live prediction and read the explanation.</li>
    <li>Use the bin guide below if you're unsure where something should go.</li>
  </ol>

  <button type="button" onclick="init()">Start</button>

  <div id="webcam-container"></div>
  <div id="label-container"></div>

  <div id="prediction-box">Prediction will appear here...</div>

  <div class="bin-guide">
    <h3>üóëÔ∏è Bin Guide</h3>
    <p><strong>Recyclable:</strong> Clean paper, bottles, cans, cardboard.</p>
    <p><strong>Trash:</strong> Plastic bags, wrappers, dirty containers.</p>
    <p><strong>Compostable:</strong> Food scraps, napkins, yard waste.</p>
  </div>

  <button class="sound-button" onclick="toggleSound()">üîä Toggle Sound Effects</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
<script>
  const URL = "./my_model/";
  let model, webcam, labelContainer, maxPredictions;
  let soundEnabled = false;

  const sounds = {
    recyclable: new Audio('https://freesound.org/data/previews/256/256113_3263906-lq.mp3'),
    compostable: new Audio('https://freesound.org/data/previews/331/331912_3248244-lq.mp3'),
    trash: new Audio('https://freesound.org/data/previews/202/202114_3635603-lq.mp3')
  };

  function toggleSound() {
    soundEnabled = !soundEnabled;
  }

  async function init() {
    const modelURL = URL + "model.json";
    const metadataURL = URL + "metadata.json";

    model = await tmImage.load(modelURL, metadataURL);
    maxPredictions = model.getTotalClasses();

    webcam = new tmImage.Webcam(250, 250, true);
    await webcam.setup();
    await webcam.play();
    window.requestAnimationFrame(loop);

    document.getElementById("webcam-container").appendChild(webcam.canvas);
    labelContainer = document.getElementById("label-container");
    labelContainer.innerHTML = "";

    for (let i = 0; i < maxPredictions; i++) {
      labelContainer.appendChild(document.createElement("div"));
    }
  }

  async function loop() {
    webcam.update();
    await predict();
    window.requestAnimationFrame(loop);
  }

  async function predict() {
    const prediction = await model.predict(webcam.canvas);
    let highestClass = "";
    let highestProb = 0;

    for (let i = 0; i < maxPredictions; i++) {
      const prob = prediction[i].probability;
      const name = prediction[i].className;

      labelContainer.childNodes[i].innerHTML = `${name}: ${prob.toFixed(2)}`;

      if (prob > highestProb) {
        highestProb = prob;
        highestClass = name;
      }
    }

    updatePredictionBox(highestClass);
  }

  function updatePredictionBox(category) {
    const box = document.getElementById("prediction-box");

    if (category.toLowerCase() === "recyclable") {
      box.style.borderColor = "#4caf50";
      box.innerHTML = "‚ôªÔ∏è Recyclable ‚Äî This item belongs in the recycling bin!";
      if(soundEnabled) sounds.recyclable.play();
    } else if (category.toLowerCase() === "compostable") {
      box.style.borderColor = "#8bc34a";
      box.innerHTML = "üå± Compostable ‚Äî This can safely break down in compost.";
      if(soundEnabled) sounds.compostable.play();
    } else if (category.toLowerCase() === "trash") {
      box.style.borderColor = "#c62828";
      box.innerHTML = "üóëÔ∏è Trash ‚Äî This item cannot be recycled or composted.";
      if(soundEnabled) sounds.trash.play();
    } else {
      box.style.borderColor = "#a5d6a7";
      box.innerHTML = "Analyzing...";
    }
  }
</script>
</body>
</html>
</script>
